<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>OWNER-EX PRO TERMINAL</title>
    <script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        :root { --bg: #0b0e11; --panel: #161a1e; --accent: #00ffad; --red: #f6465d; --green: #0ecb81; --border: #2b2f36; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: #eaecef; font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* AUTH BOX */
        #authOverlay { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: flex; justify-content: center; align-items: center; }
        .auth-card { background: var(--panel); padding: 30px; border-radius: 12px; border: 1px solid var(--accent); width: 300px; text-align: center; }
        .auth-card input { width: 90%; padding: 10px; margin: 10px 0; background: #000; border: 1px solid var(--border); color: #fff; border-radius: 4px; }

        /* HEADER */
        header { height: 60px; background: var(--panel); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 1px solid var(--border); }
        .tool-bar { display: flex; gap: 10px; align-items: center; }
        select, .btn-small { background: #1e2329; color: white; border: 1px solid var(--border); padding: 5px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; }
        
        .account-switcher { display: flex; background: #000; border-radius: 6px; padding: 2px; border: 1px solid var(--border); }
        .acc-btn { padding: 4px 10px; border: none; background: none; color: #555; cursor: pointer; font-size: 11px; border-radius: 4px; }
        .acc-btn.active { background: var(--accent); color: #000; font-weight: bold; }

        /* LAYOUT */
        .main-container { display: grid; grid-template-columns: 50px 1fr 240px; height: calc(100vh - 60px); }
        .sidebar { border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding-top: 15px; gap: 20px; }
        
        .chart-section { display: flex; flex-direction: column; position: relative; border-right: 1px solid var(--border); }
        #chart { flex: 1; }
        .history-section { height: 160px; background: var(--panel); border-top: 1px solid var(--border); overflow-y: auto; padding: 10px; }
        
        table { width: 100%; border-collapse: collapse; font-size: 11px; text-align: left; }
        th { color: #848e9c; border-bottom: 1px solid var(--border); padding: 5px; }
        td { padding: 6px 5px; border-bottom: 1px solid #222; }

        /* TRADE PANEL */
        .trade-side { padding: 15px; background: var(--panel); display: flex; flex-direction: column; gap: 12px; }
        .input-group { background: var(--bg); border: 1px solid var(--border); border-radius: 6px; padding: 8px; }
        .input-group label { display: block; font-size: 10px; color: #848e9c; }
        .input-group input { background: transparent; border: none; color: white; width: 100%; outline: none; font-size: 16px; font-weight: bold; }

        .trade-btn { height: 50px; border: none; border-radius: 8px; font-weight: 900; cursor: pointer; font-size: 15px; transition: 0.2s; }
        .up { background: var(--green); color: #000; }
        .down { background: var(--red); color: #fff; }
        .trade-btn:disabled { opacity: 0.3; cursor: not-allowed; }

        #progress { height: 3px; background: var(--accent); width: 0%; position: absolute; bottom: 160px; transition: linear; }
    </style>
</head>
<body>

<div id="authOverlay">
    <div class="auth-card" id="regForm">
        <h3 style="color:var(--accent)">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</h3>
        <input type="text" id="rUser" placeholder="–õ–æ–≥–∏–Ω">
        <input type="password" id="rPass" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="trade-btn up" style="width:100%" onclick="auth('reg')">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
        <p style="font-size:11px; cursor:pointer" onclick="showLogin(true)">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</p>
    </div>
    <div class="auth-card" id="logForm" style="display:none">
        <h3 style="color:var(--accent)">–í–•–û–î</h3>
        <input type="text" id="lUser" placeholder="–õ–æ–≥–∏–Ω">
        <input type="password" id="lPass" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="trade-btn up" style="width:100%" onclick="auth('log')">–í–æ–π—Ç–∏</button>
        <p style="font-size:11px; cursor:pointer" onclick="showLogin(false)">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</p>
    </div>
</div>

<header>
    <div class="tool-bar">
        <div style="font-weight:900; color:var(--accent); margin-right:10px;">OWNER-EX PRO</div>
        <select id="asset" onchange="changeAsset(this.value)">
            <option value="BTCUSDT">BTC/USDT</option>
            <option value="ETHUSDT">ETH/USDT</option>
            <option value="SOLUSDT">SOL/USDT</option>
        </select>
        <select id="tf" onchange="changeTF(this.value)">
            <option value="1m">1m</option>
            <option value="5m">5m</option>
            <option value="15m">15m</option>
        </select>
        <button class="btn-small" onclick="setChartStyle('candles')">üïØÔ∏è</button>
        <button class="btn-small" onclick="setChartStyle('line')">üìà</button>
    </div>

    <div class="tool-bar">
        <div class="account-switcher">
            <button class="acc-btn active" id="btnDemo" onclick="switchAccount('demo')">DEMO</button>
            <button class="acc-btn" id="btnReal" onclick="switchAccount('real')">REAL</button>
        </div>
        <div id="displayBal" style="font-weight:bold; color:var(--green); min-width:80px;">$10,000.00</div>
    </div>
</header>

<div class="main-container">
    <div class="sidebar">
        <div onclick="alert('–ö–∞—Å—Å–∞ —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç')" style="cursor:pointer">üí≥</div>
        <div onclick="alert('–ü—Ä–æ—Ñ–∏–ª—å')" style="cursor:pointer">üë§</div>
        <div onclick="location.reload()" style="cursor:pointer">üö™</div>
    </div>

    <div class="chart-section">
        <div id="chart"></div>
        <div id="progress"></div>
        <div class="history-section">
            <table>
                <thead><tr><th>–ê–∫—Ç–∏–≤</th><th>–¢–∏–ø</th><th>–°—É–º–º–∞</th><th>–í—Ö–æ–¥</th><th>–í—ã—Ö–æ–¥</th><th>–ò—Ç–æ–≥</th></tr></thead>
                <tbody id="hList"></tbody>
            </table>
        </div>
    </div>

    <div class="trade-side">
        <div class="input-group"><label>–°–£–ú–ú–ê (USDT)</label><input type="number" id="tAmt" value="100"></div>
        <div class="input-group"><label>–í–†–ï–ú–Ø (–°–ï–ö)</label><input type="number" id="tSec" value="15"></div>
        <div style="text-align:center; color:var(--accent); font-size:22px; font-weight:bold;">+82%</div>
        <button class="trade-btn up" id="uB" onclick="execTrade('CALL')">–í–´–®–ï ‚Üë</button>
        <button class="trade-btn down" id="dB" onclick="execTrade('PUT')">–ù–ò–ñ–ï ‚Üì</button>
    </div>
</div>

<script>
    let chart, series, curSym = 'BTCUSDT', curTF = '1m', style = 'candles';
    let bals = { demo: 10000, real: 0.00 };
    let curAcc = 'demo';
    let lastPrice = 0;

    // --- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ---
    window.showLogin = (val) => {
        document.getElementById('regForm').style.display = val ? 'none' : 'block';
        document.getElementById('logForm').style.display = val ? 'block' : 'none';
    };

    window.auth = (mode) => {
        if(mode === 'reg') {
            const u = document.getElementById('rUser').value, p = document.getElementById('rPass').value;
            if(u && p) { localStorage.setItem('u_'+u, p); alert('–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.'); showLogin(true); }
        } else {
            const u = document.getElementById('lUser').value, p = document.getElementById('lPass').value;
            if(localStorage.getItem('u_'+u) === p) { document.getElementById('authOverlay').style.display = 'none'; init(); }
            else alert('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞');
        }
    };

    // --- –ì–†–ê–§–ò–ö ---
    function init() {
        if(chart) document.getElementById('chart').innerHTML = '';
        chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: { background: { color: '#0b0e11' }, textColor: '#848e9c' },
            grid: { vertLines: { color: '#111' }, horzLines: { color: '#111' } },
            timeScale: { borderColor: '#222', timeVisible: true, secondsVisible: true }
        });

        series = style === 'candles' 
            ? chart.addCandlestickSeries({ upColor: '#0ecb81', downColor: '#f6465d' })
            : chart.addAreaSeries({ lineColor: '#00ffad', topColor: 'rgba(0,255,173,0.2)', bottomColor: 'transparent' });

        updateData();
    }

    async function updateData() {
        const r = await fetch(`https://api.binance.com/api/v3/klines?symbol=${curSym}&interval=${curTF}&limit=1000`);
        const d = await r.json();
        series.setData(d.map(x => ({ time: x[0]/1000, open: +x[1], high: +x[2], low: +x[3], close: +x[4], value: +x[4] })));
        
        if(window.ws) window.ws.close();
        window.ws = new WebSocket(`wss://stream.binance.com:9443/ws/${curSym.toLowerCase()}@kline_1s`);
        window.ws.onmessage = e => {
            const k = JSON.parse(e.data).k;
            lastPrice = +k.c;
            series.update({ time: k.t/1000, open: +k.o, high: +k.h, low: +k.l, close: lastPrice, value: lastPrice });
        };
    }

    // --- –ö–ù–û–ü–ö–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê ---
    window.setChartStyle = (s) => { style = s; init(); };
    window.changeAsset = (a) => { curSym = a; init(); };
    window.changeTF = (t) => { curTF = t; init(); };

    window.switchAccount = (acc) => {
        curAcc = acc;
        document.getElementById('btnDemo').classList.toggle('active', acc === 'demo');
        document.getElementById('btnReal').classList.toggle('active', acc === 'real');
        updateBalUI();
    };

    function updateBalUI() { 
        document.getElementById('displayBal').innerText = `$${bals[curAcc].toLocaleString()}`; 
    }

    // --- –¢–û–†–ì–û–í–õ–Ø ---
    window.execTrade = (type) => {
        const amt = +document.getElementById('tAmt').value;
        const sec = +document.getElementById('tSec').value;
        if(bals[curAcc] < amt) return alert('–ú–∞–ª–æ –¥–µ–Ω–µ–≥');

        bals[curAcc] -= amt; updateBalUI();
        const startPrice = lastPrice;
        const line = series.createPriceLine({ price: startPrice, color: type==='CALL'?'#0ecb81':'#f6465d', lineWidth: 2, lineStyle: 2, title: '–í–•–û–î' });

        document.getElementById('uB').disabled = document.getElementById('dB').disabled = true;
        const prog = document.getElementById('progress');
        prog.style.transition = 'none'; prog.style.width = '0%';
        setTimeout(() => { prog.style.transition = `width ${sec}s linear`; prog.style.width = '100%'; }, 50);

        setTimeout(() => {
            const endPrice = lastPrice;
            const win = (type==='CALL' && endPrice > startPrice) || (type==='PUT' && endPrice < startPrice);
            const profit = win ? amt * 1.82 : 0;
            bals[curAcc] += profit;

            const row = `<tr><td>${curSym}</td><td style="color:${type==='CALL'?'#0ecb81':'#f6465d'}">${type}</td><td>$${amt}</td><td>${startPrice}</td><td>${endPrice}</td><td style="color:${win?'#0ecb81':'#f6465d'}">${win ? '+$'+(profit-amt).toFixed(2) : '-$'+amt}</td></tr>`;
            document.getElementById('hList').insertAdjacentHTML('afterbegin', row);

            series.removePriceLine(line);
            document.getElementById('uB').disabled = document.getElementById('dB').disabled = false;
            prog.style.width = '0%';
            updateBalUI();
        }, sec * 1000);
    };

</script>
</body>
</html>
