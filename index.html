<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>OWNER-EX PRO | LIVE TERMINAL</title>
    <script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        :root { 
            --bg: #0b0e11; --panel: #161a1e; --accent: #00ffad; 
            --red: #f6465d; --green: #0ecb81; --border: #2b2f36;
        }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: #eaecef; font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* HEADER */
        header { height: 50px; background: var(--panel); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 1px solid var(--border); }
        .balance-chip { background: var(--bg); padding: 5px 12px; border-radius: 4px; font-weight: bold; border: 1px solid var(--border); cursor: pointer; color: var(--green); }

        /* GRID */
        .terminal { display: grid; grid-template-columns: 60px 1fr 220px 240px; height: calc(100vh - 50px); }

        /* SIDEBAR */
        .sidebar { border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding-top: 15px; gap: 20px; background: var(--panel); }
        .side-btn { cursor: pointer; font-size: 20px; opacity: 0.6; transition: 0.2s; padding: 10px; border-radius: 8px; }
        .side-btn:hover { opacity: 1; background: var(--border); color: var(--accent); }

        /* MODALS */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .modal-content { background: var(--panel); padding: 30px; border-radius: 15px; border: 1px solid var(--border); width: 350px; }

        /* ORDER BOOK */
        .order-book { background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; font-family: monospace; }
        .ob-row { display: grid; grid-template-columns: 1fr 1fr; padding: 1px 10px; font-size: 11px; }

        /* TRADE PANEL */
        .trade-panel { padding: 15px; display: flex; flex-direction: column; gap: 10px; background: var(--panel); }
        .input-group { background: var(--bg); border: 1px solid var(--border); border-radius: 6px; padding: 8px; }
        .input-group label { display: block; font-size: 10px; color: #848e9c; }
        .input-group input { background: transparent; border: none; color: white; width: 100%; outline: none; font-size: 16px; font-weight: bold; }

        .btn-trade { height: 55px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .btn-up { background: var(--green); color: #000; }
        .btn-down { background: var(--red); color: #fff; }
        .btn-trade:disabled { opacity: 0.5; cursor: not-allowed; }

        #progress-container { height: 4px; background: #222; width: 100%; position: relative; }
        #progress-bar { height: 100%; background: var(--accent); width: 0%; transition: linear; }
    </style>
</head>
<body>

<header>
    <div style="font-weight:900; color:var(--accent)">OWNER-EX PRO</div>
    <div style="display:flex; gap:15px; align-items:center;">
        <div class="balance-chip" id="main-balance">$10000.00</div>
        <button onclick="location.reload()" style="background:none; border:1px solid #444; color:white; border-radius:4px; cursor:pointer;">Logout</button>
    </div>
</header>

<div class="terminal">
    <div class="sidebar">
        <div class="side-btn" onclick="alert('–ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–µ–Ω')">üìà</div>
        <div class="side-btn" onclick="showModal('cash-modal')">üí≥</div>
        <div class="side-btn" onclick="showModal('profile-modal')">üë§</div>
        <div class="side-btn" onclick="showModal('settings-modal')">‚öôÔ∏è</div>
    </div>

    <div style="display:flex; flex-direction:column; position:relative;">
        <div id="chart" style="flex:1"></div>
        <div id="progress-container"><div id="progress-bar"></div></div>
        <div style="height:100px; background:var(--panel); border-top:1px solid var(--border); padding:10px; font-size:12px;">
            <b>–ê–∫—Ç–∏–≤–Ω—ã–µ —Å–¥–µ–ª–∫–∏:</b>
            <div id="active-trades-list" style="margin-top:5px; color:var(--accent)">–°–¥–µ–ª–æ–∫ –Ω–µ—Ç</div>
        </div>
    </div>

    <div class="order-book">
        <div style="padding:10px; font-size:12px; border-bottom:1px solid var(--border)">–°–¢–ê–ö–ê–ù</div>
        <div id="asks" style="display:flex; flex-direction:column-reverse; flex:1; color:var(--red)"></div>
        <div id="price-now" style="text-align:center; font-size:16px; padding:10px; font-weight:bold; border-top:1px solid var(--border); border-bottom:1px solid var(--border)">0.00</div>
        <div id="bids" style="flex:1; color:var(--green)"></div>
    </div>

    <div class="trade-panel">
        <div class="input-group"><label>–°–£–ú–ú–ê (USDT)</label><input type="number" id="trade-amount" value="100"></div>
        <div class="input-group"><label>–í–†–ï–ú–Ø (–°–ï–ö)</label><input type="number" id="trade-time" value="10"></div>
        <div style="text-align:center; padding:10px;">
            <span style="color:var(--accent); font-size:24px; font-weight:bold;">+82%</span>
        </div>
        <button class="btn-trade btn-up" id="btn-up" onclick="startTrade('CALL')">–í–´–®–ï ‚Üë</button>
        <button class="btn-trade btn-down" id="btn-down" onclick="startTrade('PUT')">–ù–ò–ñ–ï ‚Üì</button>
    </div>
</div>

<div id="cash-modal" class="modal"><div class="modal-content"><h3>–ö–ê–°–°–ê</h3><p>–î–µ–ø–æ–∑–∏—Ç: <b>BTC, USDT, ETH</b></p><button class="btn-trade btn-up" style="width:100%" onclick="closeModals()">–ó–ê–ö–†–´–¢–¨</button></div></div>
<div id="profile-modal" class="modal"><div class="modal-content"><h3>–ü–†–û–§–ò–õ–¨</h3><p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <b>–•–æ–∑—è–∏–Ω</b></p><p>–°—Ç–∞—Ç—É—Å: <b>VIP</b></p><button class="btn-trade btn-up" style="width:100%" onclick="closeModals()">–ó–ê–ö–†–´–¢–¨</button></div></div>

<script>
    let chart, candleSeries, currentPrice = 0;
    let balance = 10000;
    const AGG = 10; // 10 —Å–µ–∫—É–Ω–¥ —Ñ–∏–∫—Å–∞—Ü–∏—è
    let currentCandle = null;

    function init() {
        chart = LightweightCharts.createChart(document.getElementById('chart'), {
            layout: { background: { color: '#0b0e11' }, textColor: '#848e9c' },
            grid: { vertLines: { color: '#1f2226' }, horzLines: { color: '#1f2226' } },
            timeScale: { borderColor: '#2b2f36', timeVisible: true, secondsVisible: true },
        });
        candleSeries = chart.addCandlestickSeries({ upColor: '#0ecb81', downColor: '#f6465d' });

        // –ü–æ–¥–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
        fetch('https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1m&limit=1000')
            .then(r => r.json())
            .then(data => {
                const f = data.map(d => ({ time: d[0]/1000, open: +d[1], high: +d[2], low: +d[3], close: +d[4] }));
                candleSeries.setData(f);
            });

        // WebSocket
        const ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@kline_1s');
        ws.onmessage = (e) => {
            const k = JSON.parse(e.data).k;
            const t = Math.floor(k.t / 1000);
            const blockStart = t - (t % AGG);
            currentPrice = parseFloat(k.c);

            if (!currentCandle || blockStart > currentCandle.time) {
                currentCandle = { time: blockStart, open: +k.o, high: +k.h, low: +k.l, close: currentPrice };
            } else {
                currentCandle.close = currentPrice;
                currentCandle.high = Math.max(currentCandle.high, currentPrice);
                currentCandle.low = Math.min(currentCandle.low, currentPrice);
            }
            candleSeries.update(currentCandle);
            document.getElementById('price-now').innerText = currentPrice.toFixed(2);
            updateOrderBook(currentPrice);
        };
    }

    function startTrade(type) {
        const amt = parseFloat(document.getElementById('trade-amount').value);
        const time = parseInt(document.getElementById('trade-time').value);
        
        if (balance < amt) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");

        balance -= amt;
        updateUI();

        const entryPrice = currentPrice;
        const entryLine = candleSeries.createPriceLine({
            price: entryPrice,
            color: type === 'CALL' ? '#0ecb81' : '#f6465d',
            lineWidth: 2,
            lineStyle: 2,
            title: `${type} $${amt}`,
        });

        // –í–∏–∑—É–∞–ª
        document.getElementById('btn-up').disabled = true;
        document.getElementById('btn-down').disabled = true;
        document.getElementById('active-trades-list').innerText = `–°–¥–µ–ª–∫–∞ ${type} –æ—Ç ${entryPrice.toFixed(2)} (${time} —Å–µ–∫)`;
        
        const bar = document.getElementById('progress-bar');
        bar.style.transition = 'none'; bar.style.width = '0%';
        setTimeout(() => {
            bar.style.transition = `width ${time}s linear`;
            bar.style.width = '100%';
        }, 50);

        // –†–µ–∑—É–ª—å—Ç–∞—Ç
        setTimeout(() => {
            const finalPrice = currentPrice;
            let win = false;
            if (type === 'CALL' && finalPrice > entryPrice) win = true;
            if (type === 'PUT' && finalPrice < entryPrice) win = true;

            if (win) {
                const profit = amt * 1.82;
                balance += profit;
                alert(`–í–´–ò–ì–†–´–®! +${profit.toFixed(2)}$`);
            } else {
                alert(`–ü–†–û–ò–ì–†–´–®! -${amt}$`);
            }

            candleSeries.removePriceLine(entryLine);
            document.getElementById('btn-up').disabled = false;
            document.getElementById('btn-down').disabled = false;
            document.getElementById('active-trades-list').innerText = `–°–¥–µ–ª–æ–∫ –Ω–µ—Ç`;
            bar.style.width = '0%';
            updateUI();
        }, time * 1000);
    }

    function updateUI() {
        document.getElementById('main-balance').innerText = `$${balance.toFixed(2)}`;
    }

    function updateOrderBook(p) {
        const a = document.getElementById('asks'); const b = document.getElementById('bids');
        a.innerHTML = ''; b.innerHTML = '';
        for(let i=0; i<10; i++) {
            a.innerHTML += `<div class="ob-row"><span>${(p+i*0.5).toFixed(1)}</span><span>${(Math.random()*2).toFixed(3)}</span></div>`;
            b.innerHTML += `<div class="ob-row"><span>${(p-i*0.5).toFixed(1)}</span><span>${(Math.random()*2).toFixed(3)}</span></div>`;
        }
    }

    function showModal(id) { document.getElementById(id).style.display = 'flex'; }
    function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }

    init();
</script>
</body>
</html>

